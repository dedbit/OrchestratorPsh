# Azure Application Certificate Authentication Setup Guide

This guide explains how to set up certificate-based authentication for an Azure application to securely access Key Vault.

## Prerequisites

* An Azure subscription
* Azure CLI installed
* PowerShell 7.0 or later
* OpenSSL (for certificate generation)
* Az PowerShell module installed

## Step 1: Create a Self-Signed Certificate

Refer to the `2-AzureConfiguration.ps1` script for automating the creation of a self-signed certificate. This script includes steps to:

1. Define parameters such as certificate name and expiry years.
2. Generate the certificate using `New-SelfSignedCertificate`.
3. Export both PFX (private key) and CER (public key) files.

The script outputs the certificate thumbprint and file paths for further use.

## Step 2: Register an Azure AD Application

The `2-AzureConfiguration.ps1` script also automates the process of:

1. Registering an Azure AD application.
2. Creating a service principal for the application.
3. Uploading the certificate to the app registration.

It ensures proper error handling and validates certificate dates before uploading. The script also sets access policies for the service principal to access secrets in Azure Key Vault.

## Step 3: Authenticate and Access Key Vault Secrets

Use the `3-KeyVaultSecrets.ps1` script to authenticate and interact with Azure Key Vault. This script demonstrates how to:

1. Authenticate using the certificate, application ID, and tenant ID.
2. Retrieve a specific secret from the Key Vault.
3. List all secrets stored in the Key Vault.

## Example Usage

To authenticate using the certificate:

```powershell
Connect-AzAccount -ServicePrincipal -CertificateThumbprint "<Thumbprint>" -ApplicationId "<AppId>" -TenantId "<TenantId>"
```

Replace `<Thumbprint>`, `<AppId>`, and `<TenantId>` with the values generated by the `2-AzureConfiguration.ps1` script.

